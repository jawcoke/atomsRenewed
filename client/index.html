<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Signup - Atoms Game Multiplayer</title>
    <link rel="stylesheet" href="style/registrationStyle.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap"
      rel="stylesheet"
    />
    <style>
      /* Hide the login and signup box by default */
      .loginBox {
        display: none;
      }
      .signupBox {
        display: none;
      }
      .userBox {
        display: none;
      }
      .guestBox {
        display: block;
      }
    </style>
  </head>
  <body>
    <div class="centered-container">
      <!-- GUEST BOX  -->
      <!-- GUEST BOX  -->
      <!-- GUEST BOX  -->
      <!-- GUEST BOX  -->
      <div class="guestBox" id="guestBox">
        <div class="form-box">
          <form class="form">
            <span class="title">Guest</span>
            <div class="form-container">
              <input type="text" class="input" placeholder="nick" />
            </div>
            <a href="#" id="showUserData" class="button">Run it</a>
          </form>
          <div class="form-section">
            <p>have an account? <a href="#" id="showLogin">log in</a></p>
          </div>
        </div>
      </div>
      <!-- GUEST BOX  -->
      <!-- GUEST BOX  -->
      <!-- GUEST BOX  -->
      <!-- GUEST BOX  -->

      <!-- USER BOX  -->
      <!-- USER BOX  -->
      <!-- USER BOX  -->
      <!-- USER BOX  -->
      <div class="userBox" id="userBox">
        <div class="form-box">
          <form class="form">
            <span class="title">User!</span>
          </form>

          <div class="form-section">
            <p>Current level: 1</p>
            <p>Global Rnk: N/A</p>
            <p>Win Rate: 0%</p>
            <p>XP: 0/10</p>
          </div>

          <div class="form-section">
            <p>Wins: 0</p>
          </div>
          <div class="form-section">
            <p>Losses: 0</p>
          </div>
          <div class="form-section">
            <p>*Guest Session*</p>
          </div>
        </div>
      </div>
      <!-- USER BOX  -->
      <!-- USER BOX  -->
      <!-- USER BOX  -->
      <!-- USER BOX  -->

      <!-- LOGIN BOX -->
      <!-- LOGIN BOX -->
      <!-- LOGIN BOX -->
      <!-- LOGIN BOX -->
      <div class="loginBox" id="loginBox">
        <div class="form-box">
          <form class="form" action="login.php" method="POST">
            <span class="title">Login</span>
            <div class="form-container">
              <input
                type="text"
                name="username"
                class="input"
                placeholder="Username"
                required
              />
              <input
                type="password"
                name="password"
                class="input"
                placeholder="Password"
                required
              />
            </div>
            <a href="#" id="showUserData" class="button">Run it</a>
          </form>
          <div class="form-section">
            <p>
              <a href="#" id="showSignup">Sign up</a>
              <a href id="showGuest">Guest</a>
            </p>
          </div>
        </div>
      </div>
      <!-- LOGIN BOX -->
      <!-- LOGIN BOX -->
      <!-- LOGIN BOX -->
      <!-- LOGIN BOX -->

      <!-- SIGNUP BOX -->
      <!-- SIGNUP BOX -->
      <!-- SIGNUP BOX -->
      <!-- SIGNUP BOX -->
      <div class="signupBox" id="signupBox">
        <div class="form-box">
          <form id="signupForm">
            <input
              type="text"
              name="user"
              class="input"
              placeholder="Username"
              required
            />
            <input
              type="text"
              name="email"
              class="input"
              placeholder="Email"
              required
            />
            <input
              type="password"
              name="password"
              class="input"
              placeholder="Password"
              required
            />
            <button type="submit" class="button">Sign Up</button>
          </form>

          <div class="form-section">
            <p>
              <a href="#" id="showLogin2">Login In</a>
              <a href id="showGuest">Guest</a>
            </p>
          </div>
        </div>
      </div>
      <!-- SIGNUP BOX -->
      <!-- SIGNUP BOX -->
      <!-- SIGNUP BOX -->
      <!-- SIGNUP BOX -->

      <!-- DASHBOARD BOX -->
      <!-- DASHBOARD BOX -->
      <!-- DASHBOARD BOX -->
      <!-- DASHBOARD BOX -->
      <div class="dashboardBox">
        <h2>Dashboard</h2>
        <!-- Empty Dashboard title -->
        <ul class="server-list">
          <li><a href="#">Server 1 Join</a></li>
          <li><a href="#">Server 2 Join</a></li>
          <li><a href="#">Server 3 Join</a></li>
          <li><a href="#">Server 4 Join</a></li>
          <li><a href="#">Server 5 Join</a></li>
        </ul>
      </div>
    </div>
    <!-- DASHBOARD BOX -->
    <!-- DASHBOARD BOX -->
    <!-- DASHBOARD BOX -->
    <!-- DASHBOARD BOX -->

    <script>
      // Add event listener to the "log in" link FOR guestBox
      document
        .getElementById("showLogin2")
        .addEventListener("click", function (event) {
          event.preventDefault();
          document.getElementById("loginBox").style.display = "block"; // this shows the guest box
          document.querySelector(".signupBox").style.display = "none";
        });

      document
        .getElementById("showLogin")
        .addEventListener("click", function (event) {
          event.preventDefault(); // Prevent default link behavior
          document.getElementById("loginBox").style.display = "block"; // Show the login box
          document.querySelector(".guestBox").style.display = "none"; // Hide the signup box
        });

      document
        .getElementById("showSignup")
        .addEventListener("click", function (event) {
          event.preventDefault();
          document.getElementById("signupBox").style.display = "block"; // this shows the signup box
          document.querySelector(".loginBox").style.display = "none"; // hides the login box xD
        });

      document
        .getElementById("showUserData")
        .addEventListener("click", function (event) {
          event.preventDefault();
          document.getElementById("userBox").style.display = "block";
          document.querySelector(".loginBox").style.display = "none";
        });

      document
        .getElementById("signupForm")
        .addEventListener("submit", async (event) => {
          event.preventDefault(); // Prevent form from refreshing the page

          const formData = new FormData(event.target);
          const data = {
            user: formData.get("user"),
            email: formData.get("email"),
            password: formData.get("password"),
          };

          try {
            const response = await fetch("/users", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify(data),
            });

            if (response.ok) {
              const result = await response.json();
              console.log(result.message);
              alert("User created successfully!");
            } else {
              console.error("Failed to create user");
              alert("Error: Unable to create user");
            }
          } catch (err) {
            console.error(err);
            alert("An error occurred while creating the user.");
          }
        });
    </script>
  </body>
</html>
